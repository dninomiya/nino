---
title: Search Params Dialog
createdAt: 2025-11-12
sponsors: true
---

Search Params を利用してダイアログを表示することで、リロード時にダイアログの状態を再現できます。また、階層を意識せず状態を管理できるため、コンポーネントを再利用しやすくなります。

[DEMO](/examples/search-params-dialog)

## 依存のインストール

```bash
pnpm add nuqs
```

## ダイアログの作成

```tsx
import { useQueryState } from "nuqs";

export function SearchParamsDialog() {
  const [id, setId] = useQueryState("id");
  const [post, setPost] = useState<Post | null>(null);

  useEffect(() => {
    // ダイアログが閉じる際、コンテンツの消滅を回避しています
    if (id !== null) {
      getPost(id).then((result) => {
        setPost(result);
      });
    }
  }, [id]);


  return <Dialog open={id !== null} onOpenChange={() => setId(null)}>
    <DialogContent>
      <DialogHeader>
        <DialogTitle>{post?.title}</DialogTitle>
      </DialogHeader>
      <p>{post?.body}</p>
    </DialogContent>
  </Dialog>;
}
```

## リストの作成

```tsx
import { useQueryState } from "nuqs";

export function List() {
  const [id, setId] = useQueryState("id");
  return <div className="flex gap-2 flex-wrap">
    {items.map((item) => (
      <Button key={item} onClick={() => setId(item.toString())}>
        {item}
      </Button>
    ))}
  </div>;
}
```

## ページの作成

Cache Component において Search Params を利用する場合、 `<Suspense>` でラップする必要があります。

```tsx
import { Suspense } from "react";
import { SearchParamsDialog } from "./dialog";
import { List } from "./list";

export default function Page() {
  return <div className="space-y-4 container py-10 flex justify-center">
    <Suspense>
      <List />
      <SearchParamsDialog />
    </Suspense>
  </div>;
}
```